## 死锁

1. ### 死锁概念

   #### 定义

   两个或多个进程无限期的等待永远不会发生的条件的一种状态（结果：每个进程都永远阻塞） 

   #### 另一种定义

   在两个或多个进程中，每个进程都持有某种资源，但又继续申请其他进程已持有的某种资源。此时每个进程都拥有其运行所需的一部分资源，但是又都不够，从而每个进程都不能向前推进，陷于阻塞状态。

2. ### 死锁起因

   - 系统资源有限：资源数目不足，进程对资源的竞争而产生死锁
   - 并发进程的推进顺序不当：进程请求资源和释放资源的顺序不当，导致死锁

3. ### 死锁预防策略

   #### 死锁的必要条件

   - 互斥条件：进程互斥使用资源，资源具有独占性；
   - 不剥夺条件：进程在访问完资源前不能被其他进程强行剥夺；
   - 部分分配条件：进程边运行彼岸申请资源，临时需要临时分配（区别于：全部分配）
   - 环路条件：环中每个进程已占有的资源被前一进程申请，erect自己所申请资源又被环中后一进程占用着。

   #### 解决死锁的策略

   - 预防死锁

     通过设置某些限制条件，破坏死锁四个必要条件中的一个或多个，来防止死锁

     - 破坏互斥条件					——难
     - 破坏不剥夺条件                ——代价大
     - 破坏部分分配条件            ——预先静态分配
     - 破坏环路条件                   ——有序资源分配

   - 避免死锁

     不事先采取限制去破坏产生死锁的条件，而是在资源分配过程中，用某种方法去评估==若分配资源是否会让系统进入死锁状态==，若是，则拒绝此次分配资源，从而避免死锁的发生。

     *银行家算法*

   - 检测和恢复死锁

     允许死锁发生，但可通过检测机制及时检测出死锁状态，并精确确定与死锁有关的进程和资源，然后采取适当措施，将系统中已发生的死锁清除，将进程从死锁状态解脱出来。

     缺点1：检测方法复杂，实现难度大

     缺点2：恢复方法靠人工。撤销一些进程，回收资源再分配

   

   *预先静态分配*

   策略：进程运行前将所需资源==一次性全部==分配给它。因此进程在运行过程中不在提出资源请求，从而避免出现阻塞或者死锁。

   特点：

   - 执行可能被延迟：所需资源不能全部满足时；
   - 应用开销大：运行前估计资源需求；
   - 资源利用率低：资源被占而不用；

   

   *有序资源分配法*

   策略：

   - 系统中每个资源分配有一个唯一序号
   - 进程每次申请资源时只能申请序号更大的资源

   ![](E:/研究生/面试/操作系统.assets/image-20200702223031983.png)